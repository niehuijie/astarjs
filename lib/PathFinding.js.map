{"version":3,"file":"PathFinding.js","sourceRoot":"","sources":["../src/PathFinding.ts"],"names":[],"mappings":"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","sourcesContent":["import { Node } from \"./Node\";\r\n\r\nexport enum Types {\r\n    START = 's',\r\n    END = 'e',\r\n    WALKABLE = 'w',\r\n    NON_WALKABLE = 'nw'\r\n}\r\n\r\nexport interface WalkableTile {\r\n\ttype:number;\r\n\tweight?:number;\r\n}\r\n\r\nexport enum Heuristic {\r\n\tMANHATTAN,\r\n\tDIAGONAL\r\n}\r\n\r\nexport class PathFinding {\r\n\r\n\tprivate DEFAULT_DISTANCE:number = 10;\r\n\tprivate DIAGONAL_DISTANCE:number = 14;\r\n\r\n\tprivate heuristic:Heuristic = Heuristic.MANHATTAN;\r\n\tprivate allowDiagonal:boolean = false;\r\n\tprivate walkableTypes:(number|WalkableTile)[] = [];\r\n\tprivate start:number|{row:number, col:number};\r\n\tprivate end:number|{row:number, col:number};\r\n\r\n    constructor(options?:{heuristic:Heuristic, allowDiagonal?:boolean}){\r\n\t\tif(options && options.heuristic){\r\n\t\t\tthis.heuristic = options.heuristic;\r\n\t\t\tthis.allowDiagonal = options.allowDiagonal || false;\r\n\t\t}\r\n\t}\r\n\t\r\n\tpublic setWalkable(...args:(number|WalkableTile)[]){\r\n\t\tthis.walkableTypes = this.walkableTypes.concat(...args)\r\n\t\t\t.map((tileType: number | WalkableTile) => {\r\n\t\t\t\tif(Object.prototype.toString.apply(tileType).indexOf('Number') > -1){\r\n\t\t\t\t\treturn {type: tileType as number, weight:1};\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn tileType\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\treturn this;\r\n\t}\r\n\r\n\tpublic setStart(start:number|{row:number, col:number}){\r\n\t\tthis.start = start;\r\n\t\treturn this;\r\n\t}\r\n\r\n\tpublic setEnd(end:number|{row:number, col:number}){\r\n\t\tthis.end = end;\r\n\t\treturn this;\r\n\t}\r\n\r\n\tprivate gameMapToPathfind(map: number[][]): (number|Types)[][] {\r\n\t\tconst isStartObject:boolean = typeof this.start === \"number\";\r\n\t\tconst isEndObject:boolean = typeof this.end === \"number\";\r\n        return map.map((row, rowIndex)=>{\r\n            return row.map((id, colIndex) => {\r\n\t\t\t\tif(isStartObject && this.start == id ||\r\n\t\t\t\t\t!isStartObject && (this.start as {row:number, col:number}).row == rowIndex && \r\n\t\t\t\t\t(this.start as {row:number, col:number}).col == colIndex){\r\n\t\t\t\t\treturn Types.START;\r\n\t\t\t\t} else if(isEndObject && this.end == id ||\r\n\t\t\t\t\t!isEndObject && (this.end as {row:number, col:number}).row == rowIndex && \r\n\t\t\t\t\t(this.end as {row:number, col:number}).col == colIndex){\r\n\t\t\t\t\treturn Types.END;\r\n\t\t\t\t} else if(this.isTileWalkable(id)){\r\n\t\t\t\t\tlet item = this.getTileWalkable(id);\r\n                    return item.weight ? item.weight : 0;\r\n                } else {\r\n                     return Types.NON_WALKABLE;\r\n                }\r\n             });\r\n        });\r\n\t}\r\n\t\r\n\tprivate isTileWalkable(mapItem:number) {\r\n\t\treturn this.walkableTypes.some((type:WalkableTile) => type.type == mapItem);\r\n\t}\r\n\r\n\tprivate getTileWalkable(mapItem:number):WalkableTile {\r\n\t\treturn this.walkableTypes.filter((type:WalkableTile) => type.type == mapItem)[0] as WalkableTile;\r\n\t}\r\n\r\n    public find(map: number[][]): {col:number,row:number}[]{\r\n\t\tif(this.start == undefined || this.start == null){\r\n\t\t\tthrow new Error('There is no start point. Please, use setStart() to configure the path\\'s start point.');\r\n\t\t}\r\n\r\n\t\tif(this.end == undefined || this.end == null){\r\n\t\t\tthrow new Error('There is no end point. Please, use setEnd() to configure the path\\'s end point.');\r\n\t\t}\r\n\r\n\t\tlet finalMap:(number|Types)[][] = this.gameMapToPathfind(map);\r\n\t\tlet firstElement = (typeof this.start !== \"number\") ? new Node(this.start.row, this.start.col, 0) : this.findStartElement(finalMap);\r\n\t\tlet lastElement = (typeof this.end !== \"number\") ? new Node(this.end.row, this.end.col, 0) : this.findEndElement(finalMap);\r\n        return this.findBestPath(firstElement, lastElement, finalMap);\r\n    }\r\n\r\n\tprivate findStartElement(map:(number|Types)[][]): Node {\r\n    \tlet startPoint:Node = this.findElement(map, Types.START) as Node;\r\n    \tif(startPoint == null){\r\n    \t\tthrow new Error('Couldn\\'t find a start point.');\r\n\t\t}\r\n\t\treturn startPoint;\r\n\t}\r\n\r\n\tprivate findEndElement(map:(number|Types)[][]): Node {\r\n\t\tlet endPoint:Node = this.findElement(map, Types.END) as Node;\r\n\t\tif(endPoint == null){\r\n\t\t\tthrow new Error('Couldn\\'t find a end point.');\r\n\t\t}\r\n\t\treturn endPoint;\r\n\t}\r\n\r\n\tprivate findElement(map:(number|Types)[][], value:(number|Types)): Node | null {\r\n\t\tlet el = null;\r\n\t\tmap.forEach((element, indexRow) => {\r\n\t\t\telement.forEach((element, indexCol) => {\r\n\t\t\t\tif(element == value){\r\n\t\t\t\t\tel = new Node(indexRow, indexCol, 0);\r\n\t\t\t\t} \r\n\t\t\t});\r\n\t\t});\r\n\t\treturn el;\r\n\t}\r\n\r\n    private findBestPath(firstElement: Node, lastElement:Node, map: (number|Types)[][]): {col:number,row:number}[]{\r\n\r\n\t\tlet closedList: Node[] = [];\r\n\t\tlet openList: Node[]= [];\r\n\t\tlet isFinished: boolean = false;\r\n\t\tlet lastNode:Node = firstElement;\r\n\t\tlet lastNodeAdjacents;\r\n        closedList.push(firstElement);\r\n\r\n        while(!isFinished){\r\n            this.updateLists(map, lastNode, closedList, openList, lastElement);\r\n\t\t\tif(openList.length > 0)closedList.push(openList.pop() as Node);\r\n\r\n\t\t\tlastNode = closedList[closedList.length -1];\r\n\r\n\t\t\tlastNodeAdjacents = this.findAdjacents(map, lastNode).filter(\r\n\t\t\t\t(elementAdjacent:Node) =>\r\n\t\t\t\t\tthis.elementNotExistsInside(openList, elementAdjacent) &&\r\n\t\t\t\t\tthis.elementNotExistsInside(closedList, elementAdjacent));\r\n\r\n            isFinished = this.isNodeEqual(closedList[closedList.length-1],lastElement) ||\r\n\t\t\t\t(openList.length == 0 && !lastNodeAdjacents.length);\r\n        }\r\n\r\n        return (openList.length > 0) ? this.getPath(closedList[closedList.length-1]) : [];\r\n    }\r\n\r\n\tprivate updateLists(map:(number|Types)[][], currentNode:Node, closedList:Node[], openList: Node[], lastElement:Node){\r\n\r\n    \t//get all adjacents position possibilities that we don't have in the closed list\r\n\t\tlet validAdjacents = this.findAdjacents(map, currentNode).filter(\r\n\t\t\t(elementAdjacent:Node) => this.elementNotExistsInside(closedList, elementAdjacent));\r\n\r\n\t\t//get all adjacents position possibilities that we have in the open list and don't have inside the closed list\r\n\t\tlet validAdjacentsOpenList = validAdjacents.filter(\r\n\t\t\t(elementAdjacent:Node) => this.elementExistsInside(openList, elementAdjacent));\r\n\r\n\t\t//update distance values if the new potencial Node position on the path is longer than the current one\r\n\t\tvalidAdjacentsOpenList.forEach((elementAdjacent:Node) => {\r\n\t\t\tlet validElement = openList.filter((element:Node) => this.isNodeEqual(element, elementAdjacent))[0];\r\n\t\t\tif( currentNode.getG() + this.getMoveValue(validElement, currentNode) < validElement.getG()){\r\n\t\t\t\tvalidElement.setG(this.getMoveValue(validElement, currentNode));\r\n\t\t\t\tvalidElement.setParent(currentNode);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t//get all adjacents posiiton possibilities that we don't have in the open list and don't have inside the closed list\r\n\t\tlet validAdjacentsNewOpenList = validAdjacents.filter(\r\n\t\t\t(elementAdjacent:Node) => this.elementNotExistsInside(openList, elementAdjacent));\r\n\r\n\t\t//update distance values for the potencial new positions in the open list\r\n\t\tvalidAdjacentsNewOpenList.forEach((element) => {\r\n\t\t\telement.setParent(currentNode);\r\n\t\t\telement.setH(this.distanceBetweenNodes(element, lastElement));\r\n\t\t\telement.setG(this.getMoveValue(currentNode, element));\r\n\t\t\topenList.push(element);\r\n\t\t});\r\n\r\n\t\topenList.sort((a,b) => b.getValue() - a.getValue());\r\n\t}\r\n\r\n\tprivate elementNotExistsInside(list:Node[], element:Node){\r\n\t\treturn !this.elementExistsInside(list, element);\r\n\t}\r\n\r\n\tprivate elementExistsInside(list:Node[], element:Node){\r\n\t\treturn list.some((el:Node) => {\r\n\t\t\treturn this.isNodeEqual(el, element)\r\n\t\t})\r\n\t}\r\n\r\n\tprivate distanceBetweenNodes(initialNode:Node, finalNode:Node){\r\n\t\tlet col = Math.abs(finalNode.getCol() - initialNode.getCol());\r\n\t\tlet row = Math.abs(finalNode.getRow() - initialNode.getRow());\r\n\r\n\t\tif(this.heuristic === Heuristic.MANHATTAN){\r\n\t\t\treturn this.DEFAULT_DISTANCE*(col + row);\r\n\t\t} else {\r\n\t\t\treturn this.DEFAULT_DISTANCE*(col + row) + (this.DIAGONAL_DISTANCE -2*this.DEFAULT_DISTANCE)*Math.min(col,row);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate getMoveValue(node:Node, newNode:Node){\r\n\t\tif(node.getRow() != newNode.getRow() && node.getCol() != newNode.getCol()) return this.DIAGONAL_DISTANCE*(1+newNode.getWeight());\r\n\t\telse return this.DEFAULT_DISTANCE*(1+newNode.getWeight());\r\n\t}\r\n\r\n\tprivate findAdjacents(map:(number|Types)[][], node:Node) : Node[] {\r\n\r\n\t\tlet adjacents: Node[] = [];\r\n\t\tlet diagonal = [[-1,-1], [-1,1], [1,-1], [1,1]];\r\n\t\tlet square = [[-1,0], [0,-1], [0,1], [1,0]];\r\n\r\n\t\tlet mapElements = map;\r\n\t\tlet x, y = 0;\r\n\r\n\t\tfor(let v = 0; v < square.length; v++){\r\n\t\t\tx = node.getRow() + square[v][0];\r\n\t\t\ty = node.getCol() + square[v][1];\r\n\r\n\t\t\tif(x > -1 && y > -1 && x < mapElements.length && y < mapElements[x].length\r\n\t\t\t\t&& (this.isNumber(mapElements[x][y]) || mapElements[x][y] == Types.END )){\r\n\t\t\t\tadjacents.push(new Node(x, y, mapElements[x][y] as number));\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet addAdjacents = false;\r\n\r\n\t\tif(this.heuristic === Heuristic.DIAGONAL){\r\n\t\t\tfor(let v = 0; v < diagonal.length; v++){\r\n\t\t\t\tx = node.getRow() + diagonal[v][0];\r\n\t\t\t\ty = node.getCol() + diagonal[v][1];\r\n\t\r\n\t\t\t\tif(x > -1 && y > -1 && x < mapElements.length && y < mapElements[x].length\r\n\t\t\t\t\t&& (this.isNumber(mapElements[x][y]) || mapElements[x][y] == Types.END )){\r\n\t\t\t\t\t\t\r\n\t\t\t\t\tif(!this.allowDiagonal){\r\n\t\t\t\t\t\taddAdjacents = false;\r\n\t\t\t\t\t\tfor (let index = 0; index < diagonal.length; index++) {\r\n\t\t\t\t\t\t\tif(index == v && this.isNumber(mapElements[x-diagonal[v][0]][y]) && \r\n\t\t\t\t\t\t\t\tthis.isNumber(mapElements[x][y-diagonal[v][1]])){\r\n\t\t\t\t\t\t\t\t\taddAdjacents = true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(addAdjacents){\r\n\t\t\t\t\t\t\tadjacents.push(new Node(x, y, mapElements[x][y] as number));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else { \r\n\t\t\t\t\t\tadjacents.push(new Node(x, y, mapElements[x][y] as number));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn adjacents;\r\n\t}\r\n\r\n\tprivate isNumber(item:number|Types): boolean {\r\n\t\treturn Object.prototype.toString.apply(item).indexOf('Number') > -1\r\n\t}\r\n\r\n\tprivate getPath(node:Node):{col:number,row:number}[] {\r\n        let currentNode = node;\r\n        let listPath = [];\r\n        while(currentNode){\r\n            listPath.push(this.nodeToObject(currentNode));\r\n            currentNode = currentNode.getParent();\r\n        }\r\n        return listPath.reverse();\r\n    }\r\n\r\n\tprivate nodeToObject(node:Node){\r\n\t\treturn {col: node.getCol(), row: node.getRow()};\r\n\t}\r\n\r\n\tprivate isNodeEqual(element:Node, element0:Node):boolean{\r\n        return (element.getRow() == element0.getRow() && element.getCol() == element0.getCol());\r\n\t}\r\n\r\n}"]}